@model Models.ViewModels.LibroVM

<form asp-action="UpDelete" asp-controller="Libro" method="post" enctype="multipart/form-data">
	@Html.AntiForgeryToken()
    <input asp-for="Libro.IdLibro" type="hidden" name="Libro.IdLibro" value="@Model.Libro.IdLibro" />

    <div class="modal-header"
         style="background-color: #8C2445; color: white; font-weight: bold; height: 100px; position: relative;">
        <h1 class="modal-title fs-2" id="staticBackdropLabel"
            style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 200px;">
			Agregar libro
        </h1>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"
                style="position: absolute; top: 65%; left: 95%; transform: translate(-50%, -50%);
               width: 10px;">
        </button>
    </div>
    <div class="modal-body">
        <div class="container">
            <div class="row">
                <div class="col columnaIzq">
                    <h4 class="titulo-imagen">Imagen</h4>
                    <!-- Input oculto para la imagen-->
                    <input asp-for="Imagen" type="file" id="fileInput" accept="image/*" hidden onchange="previewImage(event)" />

                    <!-- Área interactiva -->
                    <div class="image-placeholder text-center border rounded p-4 w-100 h-75"
                         id="imagePreview"
                         onclick="document.getElementById('fileInput').click();"
                         style="cursor: pointer; width: 100px; height: 100px; overflow: hidden; display: flex; align-items: center; justify-content: center;">

                        @if (Model.Imagen != null)
                        {
                            <img src="@Url.Content(Model.Libro.ImagenUrl)"
                                 class="img-fluid w-100 h-100 object-fit-cover rounded"
                                 alt="Imagen libro" />
                        }
                        else
                        {
                            <div class="text-center">
                                <i class="bi bi-plus-lg" style="font-size: 2rem;"></i>
                                <label asp-for="Imagen" class="mt-2 text-muted d-block">Haz clic para subir una imagen</label>
                            </div>
                        }
                    </div>
                    <div class="row">
                        <div class="d-grid gap-2 d-md-block contenedor-botones">
                            <button class="btn btn-editar" name="accion" value="actualizar" type="submit" title="actualizar">
                                <i class="fa-solid fa-pen-to-square"></i>
                            </button>
                            <button class="btn btn-eliminar" name="accion" value="eliminar" type="submit" title="eliminar">
                                <i class="fa-solid fa-trash-can"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="col columnaDere">
                    <h3 class="titulo-datos">Datos</h3>
                    <div class="form-group mb-3">
                        <label asp-for="Libro.Titulo">Título</label>
                        <input asp-for="Libro.Titulo" class="form-control" />

                    </div>
                    <div class="form-group mb-3">
                        <label asp-for="Libro.ISBN">ISBN</label>
                        <input asp-for="Libro.ISBN" class="form-control" />
                        <span asp-validation-for="Libro.ISBN"></span>
                    </div>
                    <div class="form-group mb-3">
                        <label asp-for="Libro.FechaPublicacion"></label>
                        <input asp-for="Libro.FechaPublicacion" class="form-control" type="date" />
                    </div>
                    <div class="form-group mb-3">
                        <label asp-for="Libro.ClasificacionEdad"></label>
                        <input asp-for="Libro.ClasificacionEdad" class="form-control" />
                    </div>
                    <div class="form-group mb-3">
                        <label asp-for="Libro.Stock"></label>
                        <input asp-for="Libro.Stock" class="form-control" readonly />
                    </div>
                    <div class="form-group mb-3">
                        <label asp-for="Libro.Descripcion">Descripcion</label>
                        <textarea asp-for="Libro.Descripcion" class="form-control" rows="5" ></textarea>
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>
<script>
    function previewImage(event) {
        const file = event.target.files[0];
        const preview = document.getElementById('imagePreview');

        if (file && file.type.startsWith("image/")) {
            const reader = new FileReader();
            reader.onload = function (e) {
            preview.innerHTML = `<img src="${e.target.result}" class="rounded" style="width: 300px; height: 400px; object-fit: cover;" alt="Imagen previa">`;
            };
            reader.readAsDataURL(file);
        }
    }
</script>